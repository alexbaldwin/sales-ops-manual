---
layout: default
toc: true
---

{% if page.markdown %}
{% assign prose = page.markdown %}
{% else %}
{% assign prose = content %}
{% endif %}

{% assign posts = site.data.posts.post %}
{% assign sorted_posts = posts | sort: 'created_at' | reverse %}

{% for post in sorted_posts %}
  {% if post.title == page.title %}

    {% assign position = forloop.index %}

    {% if position == forloop.length %}
      {% for p in sorted_posts limit:1 offset:0 %}
        {% assign next_post = p %}
      {% endfor %}
    {% else %}
      {% for p in sorted_posts limit:1 offset:position %}
        {% assign next_post = p %}
      {% endfor %}
    {% endif %}

    {% if position == 1 %}
      {% assign last_offset = forloop.length | minus:1 %}
      {% for p in sorted_posts limit:1 offset:last_offset %}
        {% assign previous_url = p.title | slugify %}
      {% endfor %}
    {% else %}
      {% assign pos = position | minus:2 %}
      {% for p in sorted_posts limit:1 offset:pos %}
        {% assign previous_url = p.title | slugify %}
      {% endfor %}
    {% endif %}

  {% endif %}
{% endfor %}

<div class="mx-auto lg-container px4 py3">
  <div class="clearfix mxn2 flex">
      <header class="col-12 md-col-8 px2">
        <p class="mb3 semibold" style="color: #{{ page.platform.color }}">
            {{ page.platform.title }}
          </p>
        <h1 class="mt0 mb3">
          <a href="/posts/{{ page.title | slugify }}/" class="black">
            {{ page.title }}
          </a>
        </h1>
      </header>
  </div>
  <div class="clearfix mxn2 flex">
    <div class="col-12 md-col-8 px2">
      <section class="prose">
        {{ prose | markdownify }}
        <p>
        </p>
      </section>
    </div>
    <nav class="col-4 px2 sticky top-0 md-show toc-border">
      <div class="sticky top-0 mb4">
        {{ prose | markdownify | toc_only }}
      </div>
    </nav>
  </div>
</div>

{% if page.markdown %}
<aside>
    <article class="pa3 pt0 ph5-l tc">
  <div class="pv3 pv4-m pv4-l ph3 ph5-m ph5-l">
      <h6 class="b ttu f6 moon-gray ph3 pv2 dib bg-white mb3 br2">
        Read this next
      </h6>

    <h2 class="f3 f2-m f1-l mb0 mt2">
      <a href="/posts/{{ next_post.title | slugify }}" class="link dim near-black">
        {{ next_post.title }}
      </a>
    </h2>

    <section class="pb3">
      <p class="lh-copy f5 pb2 ph6-l">
            {{ next_post.markdown | markdownify | strip_html | truncate: 270 }}
      </p>

      <a class="link blue dim ttu b f6" href="/posts/{{ next_post.title | slugify }}">
        Read On
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="1em" width="1em" fill="currentcolor" class="ml2 muted-blue relative top-px-2" viewBox="0 0 30 30">
           <use xlink:href="#right_arrow"></use>
         </svg>
      </a>
    </section>

  </div>
</article>
</aside>
{% endif %}
